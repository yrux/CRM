"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[851],{4281:(t,e,n)=>{n.d(e,{Z:()=>c});var r=n(7757),a=n.n(r);function s(t,e,n,r,a,s,i){try{var o=t[s](i),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(r,a)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){s(i,r,a,o,u,"next",t)}function u(t){s(i,r,a,o,u,"throw",t)}o(void 0)}))}}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=n(9669);const c=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,s,c,d,l,v,m;return e=t,n=[{key:"getlist",value:function(t){return u.get("/api/marketing_budgets".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))}},{key:"delete",value:function(t){t.query;var e=t.id;return u.delete("/api/marketing_budgets/".concat(e))}},{key:"create",value:(m=i(a().mark((function t(e){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.post("/api/marketing_budgets",e).then((function(t){return{status:1,data:t.data.data}})).catch((function(t){return{status:0,data:t.response.data.errors}}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)}))),function(t){return m.apply(this,arguments)})},{key:"get",value:(v=i(a().mark((function t(e){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.get("/api/marketing_budgets/".concat(e));case 2:return n=t.sent,t.abrupt("return",n.data.data);case 4:case"end":return t.stop()}}),t)}))),function(t){return v.apply(this,arguments)})},{key:"update",value:(l=i(a().mark((function t(e,n){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.append("_method","put"),t.next=3,u.post("/api/marketing_budgets/"+n,e).then((function(t){return{status:1,data:t.data.data}})).catch((function(t){return{status:0,data:t.response.data.errors}}));case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)}))),function(t,e){return l.apply(this,arguments)})},{key:"getDailyBudget",value:(d=i(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.get("/api/current-budget?period="+e).then((function(t){return{status:1,data:t.data}}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t){return d.apply(this,arguments)})},{key:"getDailyBudgetDetail",value:(c=i(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.get("/api/marketing_budgets/"+e+"/spendings?sortCol=date&sortByDesc=1").then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"saveDailyBudgetDetail",value:(s=i(a().mark((function t(e,n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.post("/api/marketing_budgets/"+e+"/spendings",n).then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t,e){return s.apply(this,arguments)})}],n&&o(e.prototype,n),r&&o(e,r),t}())},7851:(t,e,n)=>{n.r(e),n.d(e,{default:()=>m});var r=n(7757),a=n.n(r),s=n(4281);const i={props:{dialog:{type:Boolean,default:!1},spendings:{type:Array,default:[]}},data:function(){return{form:{date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),budget:0},menu:!1}},methods:{closeDialog:function(){this.$emit("closeDetailedBudgetModal")},saveBudget:function(){this.$emit("saveBudgetDaily",{date:this.form.date,budget:this.form.budget})}}};var o=n(1900);const u=(0,o.Z)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",persistent:"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-toolbar",{attrs:{dark:"",color:"primary"}},[n("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){return t.closeDialog()}}},[n("v-icon",[t._v("mdi-close")])],1),t._v(" "),n("v-toolbar-title",[t._v("Detail Budget Report")]),t._v(" "),n("v-spacer")],1),t._v(" "),n("v-row",{staticClass:"mb-4 mt-4"},[n("v-col",{attrs:{cols:"5"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.form.date,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(e){return t.$set(t.form,"date",e)},"update:return-value":function(e){return t.$set(t.form,"date",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-text-field",t._g(t._b({attrs:{label:"Select Date","prepend-icon":"mdi-calendar",readonly:""},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}},"v-text-field",a,!1),r))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[t._v(" "),n("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}},[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){t.menu=!1}}},[t._v(" Cancel ")]),t._v(" "),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(e){return t.$refs.menu.save(t.form.date)}}},[t._v("\n              OK\n            ")])],1)],1)],1),t._v(" "),n("v-col",{attrs:{cols:"5"}},[n("v-text-field",{attrs:{label:"Budget",type:"number",min:"0"},model:{value:t.form.budget,callback:function(e){t.$set(t.form,"budget",e)},expression:"form.budget"}})],1),t._v(" "),n("v-col",{attrs:{cols:"2"}},[n("v-btn",{attrs:{color:"success"},on:{click:t.saveBudget}},[t._v(" Save "),n("v-icon",[t._v("mdi-check")])],1)],1)],1),t._v(" "),n("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[t._v("Amount")]),t._v(" "),n("th",{staticClass:"text-left"},[t._v("Date")])])]),t._v(" "),n("tbody",t._l(t.spendings,(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.spending))]),t._v(" "),n("td",[t._v(t._s(e.date))])])})),0)]},proxy:!0}])})],1)],1)}),[],!1,null,null,null).exports;function c(t,e,n,r,a,s,i){try{var o=t[s](i),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(r,a)}const d={props:{loading:{type:Boolean,default:!1},data:{type:Array,default:[]},summary:{type:Object,default:{}}},components:{DetailedBudget:u},data:function(){return{dialog:!1,selected_marketing_budget_id:0,spendings:[]}},mounted:function(){return(t=a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function i(t){c(s,r,a,i,o,"next",t)}function o(t){c(s,r,a,i,o,"throw",t)}i(void 0)}))})();var t},methods:{getDetailedBudget:function(t){var e=this;this.dialog=!0,this.selected_marketing_budget_id=t,s.Z.getDailyBudgetDetail(t).then((function(t){e.spendings=t.data}))},saveBudgetDaily:function(t){var e=this,n=new FormData;n.append("spending",t.budget),n.append("date",t.date),s.Z.saveDailyBudgetDetail(this.selected_marketing_budget_id,n).then((function(t){e.getDetailedBudget(e.selected_marketing_budget_id),e.$emit("refreshRightSummary"),e.$store.commit("setNotification","Budget Added")}))}}};function l(t,e,n,r,a,s,i){try{var o=t[s](i),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(r,a)}const v={components:{RightSummary:(0,o.Z)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",[t._l(t.data,(function(e){return n("v-col",{directives:[{name:"show",rawName:"v-show",value:0==t.loading,expression:"loading==false"}],key:e.id,attrs:{cols:"12"}},[n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("h3",[t._v(t._s(e.brand_name)+" ("+t._s(e.brand_code)+")")])]),t._v(" "),n("v-col",{attrs:{cols:"3"}},[n("v-progress-circular",{attrs:{rotate:-90,size:200,width:15,value:(e.max_spendings-e.remaining_spending)/e.max_spendings*100,color:"primary"}},[n("small",[t._v(t._s(parseFloat((e.max_spendings-e.remaining_spending)/e.max_spendings*100).toFixed(2))+"% Budget Spent."),n("br"),t._v(t._s(e.max_spendings)+"/"+t._s(e.max_spendings-e.remaining_spending))])])],1),t._v(" "),n("v-col",{attrs:{cols:"3"}},[n("v-progress-circular",{attrs:{rotate:-90,size:200,width:15,value:(e.required_leads-e.leads_count)/e.required_leads*100,color:"red"}},[n("small",[t._v(t._s(parseFloat((e.required_leads-e.leads_count)/e.required_leads*100).toFixed(2))+" % Leads Remaining."),n("br"),t._v(t._s(e.required_leads)+"/"+t._s(e.leads_count))])])],1),t._v(" "),t.summary[e.brand_id]?n("v-col",{attrs:{cols:"3"}},[n("v-list",{attrs:{subheader:""}},[n("v-subheader",[t._v("Leads Summary")]),t._v(" "),t._l(t.summary[e.brand_id],(function(e){return n("v-list-item",{key:e.lead_type},[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(e.type?e.type.type:"N/A")+" "),n("v-chip",{attrs:{draggable:""}},[t._v("\n                  "+t._s(e.leads_summary_count)+"\n                ")])],1)],1)],1)}))],2)],1):t._e(),t._v(" "),n("v-col",{attrs:{cols:"3"}},[n("v-btn",{attrs:{rounded:"",color:"primary",dark:""},on:{click:function(n){return t.getDetailedBudget(e.id)}}},[t._v("\n          View/Add Daily Budget\n        ")])],1)],1)],1)})),t._v(" "),t.loading?n("v-col",{attrs:{cols:"12"}},[n("v-sheet",{staticClass:"pa-3",attrs:{color:"lighten-5"}},t._l(5,(function(t){return n("v-skeleton-loader",{key:t,staticClass:"mb-6",attrs:{type:"list-item-avatar, divider"}})})),1)],1):t._e(),t._v(" "),n("DetailedBudget",{attrs:{spendings:t.spendings,dialog:t.dialog},on:{saveBudgetDaily:t.saveBudgetDaily,closeDetailedBudgetModal:function(e){t.dialog=!1}}})],2)}),[],!1,null,null,null).exports},data:function(){return{date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,7),marketing_budgets:[],summary:[],loaders:{rightsummary:!0}}},methods:{getMarketingBudget:function(){var t,e=this;return(t=a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loaders.rightsummary=!0,t.next=3,s.Z.getDailyBudget(e.date+"-01").then((function(t){t.status&&(e.marketing_budgets=t.data.marketing_budgets,e.summary=t.data.lead_summary)}));case 3:return t.next=5,e.$nextTick();case 5:e.loaders.rightsummary=!1;case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function i(t){l(s,r,a,i,o,"next",t)}function o(t){l(s,r,a,i,o,"throw",t)}i(void 0)}))})()}},computed:{},watch:{date:function(){this.getMarketingBudget()}},mounted:function(){this.getMarketingBudget()}};const m=(0,o.Z)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12"}},[n("v-date-picker",{staticClass:"mt-4",attrs:{type:"month",color:"green","full-width":"","show-current":!1},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"12"}},[t.marketing_budgets.length>0?n("RightSummary",{attrs:{summary:t.summary,loading:t.loaders.rightsummary,data:t.marketing_budgets},on:{refreshRightSummary:t.getMarketingBudget}}):n("h2",[t._v("Target Not yet Set for "+t._s(t.date))])],1)],1)],1)}),[],!1,null,null,null).exports}}]);